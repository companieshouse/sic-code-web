{% extends "base.njk" %}

{% from "govuk/components/input/macro.njk" import govukInput %}
{% from "govuk/components/button/macro.njk" import govukButton %}
{% from "govuk/components/table/macro.njk" import govukTable %}
{% from "govuk/components/checkboxes/macro.njk" import govukCheckboxes %}

{% block pageTitle %}
  SIC Code Search
{% endblock %}

{% block content %}
<h3 class="govuk-heading-xl">SIC Code Search</h3>

<form method="POST">

    {%if errors %}
      <p class="govuk-error-summary">A Server Error occured when trying to find your SIC Code</p>
    {% endif %}

    {{ govukInput({
    label: {
        text: "Enter keyword(s) to search for SIC code (case insensitive)",
        classes: "govuk-label--l",
        isPageHeading: true
    },
    id: "sic-code-search-name",
    name: "sicCodeSearchName",
    value: searchText
    }) }}

{{ govukCheckboxes({
  idPrefix: "match-options",
  name: "matchOptions",
  fieldset: {
    legend: {
      text: "Match Exact Phrase",
      isPageHeading: true,
      classes: "govuk-fieldset__legend--m"
    }
  },
  items: [
    {
      value: "and",
      text: "Only match when the exact phrase is found",
      checked: true if matchOptions === 'and'
    }
  ]
}) }}
    
    {{ govukButton({
    text: "Search",
    attributes: { id: "search-button" }
    }) }}
</form>

{% if matches|length %}

   {% if matches|length == 1 %}
     {% set resultsCaption = "There is " + (matches|length) + " result for '" + searchText  + "'" %}
     {% else %}
     {% set resultsCaption = "There are " + (matches|length) + " results for '" + searchText  + "'" %}
   {% endif %}

   {{ govukTable({
        caption: resultsCaption,
        captionClasses: "govuk-table__caption--m",
        head: [
          {
            text: "SIC Code",
            attributes: { id: "sic_code_header" }
          },
          {
            text: "SIC Description",
            attributes: { id: "sic_code_header" }
          },
          {
            text: "Economic Activity",
            attributes: { id: "economic_activity_header" }
          }
        ],
        rows: matches
      }) }}
{% elif matches and searchText %}
     <h3 class="govuk-heading-m" id="no_sic_code_matches_message">There are 0 results for '{{ searchText }}'</h3>
{% elif matches%}
     <h3 class="govuk-heading-m" id="no_sic_code_matches_message">No Matches</h3>
{% endif %}

{% endblock %}
